<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beans  xmlns="http://www.springframework.org/schema/beans"
		xmlns:context="http://www.springframework.org/schema/context" 
		xmlns:mvc="http://www.springframework.org/schema/mvc"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
		xsi:schemaLocation="
			http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
			http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd
			http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">
                
                
     <context:property-placeholder location="classpath*:META-INF/spring/*.properties"/>
                
    <!-- The controllers are autodetected POJOs labeled with the @Controller annotation. -->
    <context:component-scan base-package="org.esupportail.nfctag" use-default-filters="false">
        <context:include-filter expression="org.springframework.stereotype.Controller" type="annotation"/>
    </context:component-scan>
    
    <!-- Turns on support for mapping requests to Spring MVC @Controller methods
         Also registers default Formatters and Validators for use across all @Controllers -->
    <mvc:annotation-driven conversion-service="applicationConversionService">
        <mvc:argument-resolvers>
            <bean class="org.esupportail.nfctag.web.SessionAwarePageableResolver"/>
        </mvc:argument-resolvers>
    </mvc:annotation-driven>
    

    <!-- Handles HTTP GET requests for /resources/** by efficiently serving up static resources -->
    <mvc:resources location="/, classpath:/META-INF/web-resources/" mapping="/resources/**">
		<mvc:cache-control cache-public="true" max-age="86400"/>
		<mvc:resource-chain resource-cache="true">
			<mvc:resolvers>
				<mvc:version-resolver>
					<mvc:content-version-strategy patterns="/**"/>
				</mvc:version-resolver>
				<bean class="org.springframework.web.servlet.resource.PathResourceResolver"/>
			</mvc:resolvers>
		</mvc:resource-chain>
	</mvc:resources>

    <!-- Allows for mapping the DispatcherServlet to "/" by forwarding static resource 
    requests to the container's default Servlet -->
    <mvc:default-servlet-handler/>

    <bean name="multipartResolver" class="org.springframework.web.multipart.support.StandardServletMultipartResolver"/>

	<bean class="org.esupportail.nfctag.web.ApplicationConversionServiceFactoryBean" id="applicationConversionService"/>


    <!-- Template Resolver -->
    <bean id="templateResolver" class="org.thymeleaf.spring6.templateresolver.SpringResourceTemplateResolver">
        <property name="prefix" value="/WEB-INF/thymeleaf/" />
        <property name="suffix" value=".html" />
        <property name="templateMode" value="HTML" />
        <property name="characterEncoding" value="UTF-8" />
        <property name="cacheable" value="false" />
    </bean>

    <!-- Template Engine -->
    <bean id="templateEngine" class="org.thymeleaf.spring6.SpringTemplateEngine">
        <property name="templateResolver" ref="templateResolver" />
        <property name="enableSpringELCompiler" value="true"/>
        <property name="additionalDialects">
            <set>
                <bean class="nz.net.ultraq.thymeleaf.layoutdialect.LayoutDialect"/>
                <bean class="org.thymeleaf.extras.springsecurity6.dialect.SpringSecurityDialect"/>
                <bean class="org.thymeleaf.dialect.springdata.SpringDataDialect"/>
            </set>
        </property>
    </bean>

    <!-- Thymeleaf ViewResolver -->
    <bean class="org.thymeleaf.spring6.view.ThymeleafViewResolver">
        <property name="templateEngine" ref="templateEngine" />
        <property name="order" value="1" />
        <property name="viewNames">
            <list>
                <value>templates/*</value>
            </list>
        </property>
        <property name="characterEncoding" value="UTF-8" />
    </bean>

</beans>
